<!DOCTYPE html>
<html>

<head>
  <title>Deployment Information</title>
</head>

<body>
  <h1>Deployment Information</h1>

  <!-- <h2>Environment 1</h2>
  <p>Artifact Version: <span id="env1Version"></span></p>

  <h2>Environment 2</h2>
  <p>Artifact Version: <span id="env2Version"></span></p>
   -->
  <!-- Add more environments as needed -->

  <script>

    const parse = (data) => {
      // console.log(data)
      environments = data.environments;
      let body = "<table>"
      for (var i = 0; i < data.length; i++) {
        body += `<tr><td>${environments[i]._id}</td><td>${environments[i].name}</td></tr>`
      }
      body += "</table>"
      document.getElementById('data').innerHTML = body
    }

    let url = `https://api.github.com/repos/ravi-palakodeti/gha-versions/environments`;
        fetch(url)
            .then( response => response.json() )
            .then( data => parse(data) )
            .catch( error => console.log(error) )
  </script>

  <script>
    // Fetch and display the artifact versions using GitHub API
    fetch('https://api.github.com/repos/ravi-palakodeti/gha-versions/actions/artifacts')
      .then(response => response.json())
      .then(data => {
        const artifacts = data.artifacts;
        const env1Artifact = artifacts.find(artifact => artifact.name === 'Environment 1');
        const env2Artifact = artifacts.find(artifact => artifact.name === 'Environment 2');

        document.getElementById('env1Version').innerText = env1Artifact ? env1Artifact.version : 'Not deployed';
        document.getElementById('env2Version').innerText = env2Artifact ? env2Artifact.version : 'Not deployed';

        // Add more environment versions as needed
      })
      .catch(error => console.error('Error fetching artifact versions:', error));
  </script>
</body>

</html>